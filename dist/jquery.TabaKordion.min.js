/*
* jQuery TabaKordion - v2.0.0
* A fully accessible to WAI specification; tabs and accordion jQuery plugin.
* http://www.tariqkhan.co.uk/
*
* Made by Tariq Khan
* Under MIT License
*/
(function(c,l,n){function h(a,b){this.element=a;this.options=c.extend({},k,b);this._defaults=k;this._name="TabaKordion";this.$TabaKordion=c(a);this.$TabaKordion.hasClass("tabs")?this.options.accordion=!1:this.$TabaKordion.hasClass("nomultiselect")?this.options.multiSelect=!1:this.$TabaKordion.hasClass("showhide")&&(this.options.showHide=!0);this.$tabs=this.options.showHide?this.$TabaKordion:this.$TabaKordion.find(".tab");this.$panels=this.options.showHide?c(this.$TabaKordion.attr("href")):this.$TabaKordion.children(".panel"); this.keys=new m;this.bindEventHandlers();this.init()}function m(){this.tab=9;this.enter=13;this.esc=27;this.space=32;this.pageup=33;this.pagedown=34;this.end=35;this.home=36;this.left=37;this.up=38;this.right=39;this.down=40}var k={accordion:!0,openFirst:!0,multiSelect:!0,showHide:!1};c.extend(c.expr[":"],{focusable:function(a){var b=a.nodeName.toLowerCase(),d=c(a).attr("tabindex");return 1==c(a)["area"==b?"parents":"closest"](":hidden").length||!isNaN(d)&&0>d?!1:1==/input|select|textarea|button|object/.test(b)? !a.disabled:1==("a"==b||"area"==b)?0<a.href.length:!1}});h.prototype={init:function(){this.options.showHide?(this.$tabs.attr("aria-expanded","false").attr("aria-controls",this.$panels.attr("id")).prepend("<span>Show</span> "),this.$panels.attr("aria-expanded","false").attr("aria-labelledby",this.$tabs.attr("id")).attr("role","region").attr("tabindex","-1").addClass("showhide-region").hide()):(this.$panels.attr("role","tabpanel").attr("aria-hidden","true").hide(),this.$tabs.attr("role","tab").attr("aria-selected", "false").attr("tabindex","-1"),this.options.accordion?(this.options.multiSelect&&this.$TabaKordion.attr("multiselectable",!0),this.$tabs.attr("aria-expanded","false").append(' <span class="visually-hidden">(collapsed)</span>')):this.$tabs.find("a").each(function(){c(this).replaceWith("<span>"+c(this).text()+"</span>")}));var a=l.location.hash;a&&c(a).length&&(this.$tabs.removeClass("selected"),c(a).addClass("selected"),this.options.showHide&&(a=a.substring(1),this.$tabs.attr("id")!==a&&this.$panels.attr("id")!== a||this.toggleRegion()));this.options.showHide||(a=this.$tabs.filter(".selected"),!a.length&&this.options.openFirst&&(a=this.$tabs.first()),a.addClass("selected").attr("aria-selected","true").attr("tabindex","0"),this.options.accordion&&a.attr("aria-expanded","true").find(".visually-hidden").text("(expanded)"),this.$TabaKordion.find("#"+a.attr("aria-controls")).show().attr("aria-hidden","false"))},bindEventHandlers:function(){var a=this;this.$tabs.keydown(function(b){return a.tabKeyDownHandler(c(this), b)});this.$tabs.click(function(b){return a.tabClickHandler(c(this),b)});this.$tabs.focus(function(b){return a.tabFocusHandler(c(this),b)});this.$tabs.blur(function(b){return a.tabBlurHandler(c(this),b)});this.options.showHide||this.$panels.keydown(function(b){return a.panelElementsKeyDownHandler(c(this),b)});this.options.accordion&&this.$panels.click(function(b){return a.panelElementsClickHandler(c(this),b)});this.options.showHide&&this.$panels.blur(function(b){return a.panelBlurHandler(c(this),b)})}, toggleRegion:function(){var a=this.$tabs;this.$panels.slideToggle(function(){"false"===c(this).attr("aria-expanded")?(c(this).attr("aria-expanded","true").focus(),a.attr("aria-expanded","true").addClass("selected").find("span").html("Hide")):(c(this).attr("aria-expanded","false"),a.attr("aria-expanded","false").removeClass("selected").find("span").html("Show"))})},togglePanel:function(a){this.options.accordion?this.options.accordion&&!this.options.multiSelect&&(this.$tabs.attr("aria-expanded","false").find(".visually-hidden").text("(collapsed)"), this.$panels.attr("aria-hidden","true").slideUp()):this.$panels.attr("aria-hidden","true").hide();var b=this.$TabaKordion.find("#"+a.attr("aria-controls"));"true"===b.attr("aria-hidden")?(b.attr("aria-hidden","false"),this.options.accordion?(a.attr("aria-expanded","true").find(".visually-hidden").text("(expanded)"),b.slideDown()):b.show()):(b.attr("aria-hidden","true"),this.options.accordion?(a.attr("aria-expanded","false").find(".visually-hidden").text("(collapsed)"),b.slideUp()):b.hide())},switchTabs:function(a, b){a.removeClass("selected focus").attr("tabindex","-1").attr("aria-selected","false");this.options.accordion||(this.$TabaKordion.find("#"+a.attr("aria-controls")).hide().attr("aria-hidden","true"),this.$TabaKordion.find("#"+b.attr("aria-controls")).show().attr("aria-hidden","false"));b.addClass("selected").attr("aria-selected","true").attr("tabindex","0").focus()},tabKeyDownHandler:function(a,b){if(b.altKey||this.options.showHide&&b.keyCode!==this.keys.enter&&b.keyCode!==this.keys.space)return!0; switch(b.keyCode){case this.keys.enter:case this.keys.space:return this.options.accordion?(this.options.showHide?this.toggleRegion():this.togglePanel(a),b.stopPropagation(),!1):!0;case this.keys.left:case this.keys.up:if(!b.ctrlKey){var c=this.$tabs.index(a),c=0==c?this.$tabs.last():this.$tabs.eq(c-1);this.switchTabs(a,c)}b.stopPropagation();return!1;case this.keys.right:case this.keys.down:return c=this.$tabs.index(a),c=c==this.$tabs.length-1?this.$tabs.first():this.$tabs.eq(c+1),this.switchTabs(a, c),b.stopPropagation(),!1;case this.keys.home:return this.switchTabs(a,this.$tabs.first()),b.stopPropagation(),!1;case this.keys.end:return this.switchTabs(a,this.$tabs.last()),b.stopPropagation(),!1}},tabClickHandler:function(a,b){this.options.showHide?this.toggleRegion():(a.addClass("selected").attr("tabindex","0").attr("aria-selected","true"),this.$tabs.not(a).attr("tabindex","-1").attr("aria-selected","false").removeClass("selected"),this.togglePanel(a));return this.options.accordion?(b.stopPropagation(), !1):!0},tabFocusHandler:function(a,b){a.addClass("focus");return!0},tabBlurHandler:function(a,b){a.removeClass("focus");return!0},panelElementsKeyDownHandler:function(a,b){if(b.altKey)return!0;switch(b.keyCode){case this.keys.tab:var d=a.find(":focusable"),e=d.index(c(b.target)),f=this.$panels.index(a),g=this.$panels.length;if(b.shiftKey){if(0==e&&0<f)for(e=f-1;0<=e;e--)if(g=this.$panels.eq(e),f=c("#"+g.attr("aria-labelledby")),d.length=0,d=g.find(":focusable"),0<d.length)return d.last().focus(), this.$tabs.attr("aria-selected","false").removeClass("selected"),f.attr("aria-selected","true").addClass("selected"),b.stopPropagation,!1}else if(f<g&&e==d.length-1)for(e=f+1;e<g;e++){var f=this.$panels.eq(e),h=c("#"+f.attr("aria-labelledby"));d.length=0;d=f.find(":focusable");if(0<d.length)return d.first().focus(),this.$tabs.attr("aria-selected","false").removeClass("selected"),h.attr("aria-selected","true").addClass("selected"),b.stopPropagation,!1}break;case this.keys.esc:case this.keys.left:case this.keys.up:if(b.keyCode!= this.keys.esc&&!b.ctrlKey)break;c("#"+a.attr("aria-labelledby")).focus();b.stopPropagation();return!1;case this.keys.pageup:case this.keys.pagedown:if(!b.ctrlKey)break;d=this.$tabs.filter(".selected");e=this.$tabs.index(d);g=b.keyCode==this.keys.pageup?0==e?this.$tabs.last():this.$tabs.eq(e-1):e==this.$tabs.length-1?this.$tabs.first():this.$tabs.eq(e+1);this.switchTabs(d,g);b.stopPropagation();b.preventDefault();return!1}return!0},panelBlurHandler:function(a,b){this.$tabs.removeClass("selected"); return!0},panelElementsClickHandler:function(a,b){if(this.options.showHide)this.$tabs.addClass("selected");else{var d=c("#"+a.attr("aria-labelledby")).attr("tabindex","0").attr("aria-selected","true").addClass("selected");this.$tabs.not(d).attr("tabindex","-1").attr("aria-selected","false").removeClass("selected")}return!0}};c.fn.TabaKordion=function(a){return this.each(function(){c.data(this,"plugin_TabaKordion")||c.data(this,"plugin_TabaKordion",new h(this,a))})}})(jQuery,window);
